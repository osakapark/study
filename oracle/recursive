``` html
WITH
    recur (department_id,
           parent_id,
           department_name,
           lvl)
    AS
        (SELECT department_id,
                parent_id,
                department_name,
                1     AS lvl
           FROM departments
          WHERE parent_id IS NULL
         UNION ALL
         SELECT a.department_id,
                a.parent_id,
                a.department_name,
                b.lvl + 1
           FROM departments a, recur b
          WHERE a.parent_id = b.department_id)
        SEARCH DEPTH FIRST BY department_id SET order_seq
SELECT department_id, LPAD (' ', 3 * (lvl - 1)) || department_name, lvl
  FROM recur;
```
